# 통신사 재무 예측 시스템 설정

# 데이터 설정
data:
  # 지원 파일 형식: .csv, .xlsx, .xls
  raw_file: "data/raw/telecom_financial_data.xlsx"
  processed_dir: "data/processed"
  results_dir: "results"
  
  # 컬럼 매핑
  columns:
    date_col: "BASE_YM"
    year_col: "BASE_YY"
    product_col: "ENTR_3_PROD_LEVEL_NM"
    profit_source_col: "PROFT_SRC_NM"
    account_name_col: "GL_ACC_LSN_NM"
    division_col: "SUM_DIV_NM"
    value_col: "PRFIT_PERSP_1_INDX_VAL"
  
  # 계정과목 필터링 설정
  account_filtering:
    min_total_value: 1000000  # 최소 총 매출액 (백만원)
    min_occurrence: 3         # 최소 발생 횟수
    exclude_patterns: ["<할인>", "<포인트>"]  # 제외할 패턴

# 전처리 설정
preprocessing:
  # 시계열 변환
  time_series:
    freq: "M"  # 월별
    fill_method: "ffill"  # 결측치 처리 방법
    
  # 피처 엔지니어링
  features:
    # 시간적 특성
    temporal_features: ["month", "quarter", "year", "day_of_week"]
    # 계절성 특성
    seasonal_features: ["sin_month", "cos_month", "sin_quarter", "cos_quarter"]
    # 지연 특성
    lag_features: [1, 3, 6, 12]
    # 이동평균
    rolling_features: [3, 6, 12]
    
  # 정규화
  scaling:
    method: "none"  # robust, standard, minmax, none
    exclude_cols: ["date", "product", "account_name"]

# 모델 설정
model:
  # Darts TFT 모델 설정 (최신 버전 파라미터)
  tft:
    # 필수 파라미터 (29개 데이터포인트에 맞게 조정)
    input_chunk_length: 6     # 입력 시퀀스 길이 (12->6로 감소)
    output_chunk_length: 3    # 출력 시퀀스 길이 (6->3로 감소)
    
    # 모델 아키텍처 파라미터
    hidden_size: 64           # 히든 레이어 크기
    lstm_layers: 1            # LSTM 레이어 수 (3->1로 감소)
    num_attention_heads: 4    # 어텐션 헤드 수
    full_attention: false     # 전체 어텐션 사용 여부
    feed_forward: "GatedResidualNetwork"  # 피드포워드 네트워크 타입
    dropout: 0.1              # 드롭아웃 비율
    hidden_continuous_size: 8 # 연속 변수 처리 히든 크기
    
    # 특성 관련 파라미터
    use_static_covariates: true  # 정적 공변량 사용
    norm_type: "LayerNorm"       # 정규화 타입
    
    # 훈련 관련 파라미터
    n_epochs: 50              # 훈련 에포크 (100->50으로 감소)
    batch_size: 32            # 배치 크기
    optimizer_kwargs:
      lr: 0.001               # 학습률
    random_state: 42          # 랜덤 시드
    
  # Prophet 모델 설정 (보조 모델)
  prophet:
    yearly_seasonality: true
    weekly_seasonality: false
    daily_seasonality: false
    seasonality_mode: 'multiplicative'
    
  # 앙상블 설정
  use_ensemble: true  # true: TFT + Prophet 앙상블, false: TFT만 사용
  ensemble:
    methods: ["tft", "prophet"]
    weights: [0.7, 0.3]

# 예측 설정
forecasting:
  # 예측 기간
  forecast_horizon: 12  # 12개월
  # 검증 기간
  validation_periods: 6  # 6개월
  # 신뢰구간
  confidence_level: 0.95
  
  # 계층적 예측
  hierarchical:
    levels: ["product", "account_name"]
    reconciliation_method: "mint"  # minimum trace reconciliation

# 평가 설정
evaluation:
  metrics: ["mae", "mape", "rmse", "smape"]
  cv_folds: 5
  test_size: 0.2

# 시각화 설정
visualization:
  # 차트 설정
  charts:
    forecast_plot: true
    accuracy_plot: true
    feature_importance: true
    correlation_matrix: true
    seasonal_decomposition: true
    
  # 대시보드 설정
  dashboard:
    port: 8050
    host: "localhost"
    theme: "light"
    
  # 리포트 설정
  report:
    format: "html"
    include_charts: true
    include_tables: true
    include_insights: true

# 로깅 설정
logging:
  level: "INFO"
  format: "%(asctime)s - %(name)s - %(levelname)s - %(message)s"
  file: "logs/telecom_forecast.log"